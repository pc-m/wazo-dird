paths:
  /config:
    get:
      summary: Returns the current service configuration
      description: '**Required ACL:** `dird.config.read`'
      operationId: configuration_get
      tags:
        - configuration
      produces:
        - application/json
      responses:
        '200':
          description: A JSON representation of the current configuration.
  /displays:
    get:
      operationId: list_display
      summary: List displays
      description: '**Required ACL:** `dird.displays.read`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/recurse'
        - $ref: '#/parameters/order'
        - $ref: '#/parameters/direction'
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      responses:
        '200':
          description: A list of configured displays
          schema:
            $ref: '#/definitions/DisplayItems'
    post:
      summary: Create a new display configuration
      description: '**Required ACL:** `dird.displays.create`'
      operationId: create_display
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - name: body
          in: body
          description: The display configuration body
          required: true
          schema:
            $ref: '#/definitions/Display'
      responses:
        '201':
          description: The created display
          schema:
            $ref: '#/definitions/Display'
        '400':
          $ref: '#/responses/CreateError'
  /displays/{display_uuid}:
    get:
      operationId: get_display
      summary: Get display
      description: '**Required ACL:** `dird.displays.{display_uuid}.read`'
      tags:
        - configuration
      parameters:
      - $ref: '#/parameters/tenantuuid'
      - $ref: '#/parameters/displayuuid'
      responses:
        '200':
          description: Display
          schema:
            $ref: '#/definitions/Display'
        '404':
          $ref: '#/responses/NotFoundError'
    put:
      operationId: update_display
      summary: Update display
      description: '**Required ACL:** `dird.displays.{display_uuid}.update`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/displayuuid'
        - name: body
          in: body
          description: The display configuration body
          required: true
          schema:
            $ref: '#/definitions/Display'
      responses:
        '204':
          $ref: '#/responses/ResourceUpdated'
        '400':
          $ref: '#/responses/UpdateError'
        '404':
          $ref: '#/responses/NotFoundError'
    delete:
      operationId: delete_display
      summary: Delete display
      description: '**Required ACL:** `dird.displays.{display_uuid}.delete`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/displayuuid'
      responses:
        '204':
          $ref: '#/responses/ResourceDeleted'
        '404':
          $ref: '#/responses/NotFoundError'
  /sources:
    get:
      operationId: list_source
      summary: List all configured sources
      description: '**Required ACL:** `dird.sources.read`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/recurse'
        - $ref: '#/parameters/order'
        - $ref: '#/parameters/direction'
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      responses:
        '200':
          description: A list of configured sources
          schema:
            $ref: '#/definitions/SourceItems'
  /services:
    get:
      operationId: list_services
      summary: List all loaded services
      description: '**Required ACL:** `dird.services.read`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/order'
        - $ref: '#/parameters/direction'
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      responses:
        '200':
          description: A list of configured services
          schema:
            $ref: '#/definitions/ServiceItems'
  /profiles:
    post:
      operationId: create_profile
      summary: Create a new configuration profile
      description: '**Required ACL:** `dird.profiles.create`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - name: body
          in: body
          description: The profile configuration
          schema:
            $ref: '#/definitions/Profile'
      responses:
        '201':
          description: The created profile
          schema:
            $ref: '#/definitions/Profile'
        '400':
          $ref: '#/responses/CreateError'
    get:
      operationId: list_profile
      summary: List all configured profiles
      description: '**Required ACL:** `dird.profiles.read`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/recurse'
        - $ref: '#/parameters/order'
        - $ref: '#/parameters/direction'
        - $ref: '#/parameters/limit'
        - $ref: '#/parameters/offset'
      responses:
        '200':
          description: A list of configured profiles
          schema:
            $ref: '#/definitions/ProfileItems'
  /profiles/{profile_uuid}:
    get:
      operationId: get_profile
      summary: Get a profile configuration
      description: '**Required ACL:** `dird.profiles.{profile_uuid}.read`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/profileuuid'
      responses:
        '200':
          description: Profile
          schema:
            $ref: '#/definitions/Profile'
        '404':
          $ref: '#/responses/NotFoundError'
    put:
      operationId: update_profile
      summary: Update a profile configuration
      description: '**Required ACL:** `dird.profiles.{profile_uuid}.update`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/profileuuid'
        - name: body
          in: body
          description: The profile configuration body
          required: true
          schema:
            $ref: '#/definitions/Profile'
      responses:
        '204':
          $ref: '#/responses/ResourceUpdated'
        '400':
          $ref: '#/responses/UpdateError'
        '404':
          $ref: '#/responses/NotFoundError'
    delete:
      operationId: delete_profile
      summary: Delete a profile configuration
      description: '**Required ACL:** `dird.profiles.{profile_uuid}.delete`'
      tags:
        - configuration
      parameters:
        - $ref: '#/parameters/tenantuuid'
        - $ref: '#/parameters/profileuuid'
      responses:
        '204':
          $ref: '#/responses/ResourceDeleted'
        '404':
          $ref: '#/responses/NotFoundError'
parameters:
  backendname:
    required: true
    type: string
    name: backend_name
    in: path
    description: the backend's name
  displayuuid:
    required: true
    type: string
    name: display_uuid
    in: path
    description: the display's UUID
  profileuuid:
    required: true
    type: string
    name: profile_uuid
    in: path
    description: the profile's UUID
  search:
    required: false
    name: search
    in: query
    type: string
    description: Search term for filtering a list of items. Only items with a field
      containing the search term will be returned.
  sourceuuid:
    name: source_uuid
    type: string
    in: path
    description: "The source's UUID"
    required: true
  limit:
    name: limit
    in: query
    type: integer
    description: The limit defines the number of individual objects that are returned
    required: false
  offset:
    name: offset
    in: query
    type: integer
    description: The offset defines the offsets the start by the number specified
    default: 0
    required: false
responses:
  CreateError:
    description: An error occurred when creating the resource
    schema:
      $ref: '#/definitions/APIError'
  NotFoundError:
    description: The resource requested was not found on the server
    schema:
      $ref: '#/definitions/Error'
  ResourceUpdated:
    description: Resource was updated successfully
  ResourceDeleted:
    description: Resource was deleted successfully
  UpdateError:
    description: An error occurred when updating the resource
    schema:
      $ref: '#/definitions/APIError'
definitions:
  APIError:
    type: object
    properties:
      timestamp:
        type: number
      message:
        type: string
      resource:
        type: string
      details:
        type: object
  Display:
    title: Display
    allOf:
      - properties:
          uuid:
            type: string
            description: The display's UUID
            readOnly: true
          name:
            type: string
            description: The name of the display
          fields:
            type: array
            items:
              $ref: '#/definitions/DisplayField'
            default: []
      - required:
          - name
  DisplayIdentifier:
    title: DisplayUUID
    allOf:
      - properties:
          uuid:
            type: string
            description: "The display's UUID"
      - required:
          - uuid
  DisplayField:
    title: Field
    allOf:
      - properties:
          name:
            type: string
            description: The name of the field to display in this column
          title:
            type: string
            description: A human readable name for this column
          type:
            type: string
            description: The type of this column
          default:
            type: string
            description: A default value if theres no result in this column
          number_display:
            type: string
            description: A format string that overrides the default display. for number columns only.
      - required:
          - name
  DisplayItems:
    title: DisplayItems
    allOf:
      - properties:
          items:
            type: array
            items:
              $ref: '#/definitions/Display'
            readOnly: true
          total:
            type: integer
            description: The number of configured displays
            readOnly: true
          filtered:
            type: integer
            description: The number of configured displays matching the searched terms
            readOnly: true
      - required:
          - items
          - total
          - filtered
  Profile:
    title: Profile
    allOf:
      - properties:
          uuid:
            type: string
            readOnly: true
          name:
            type: string
            description: The name of the profile
          display:
            $ref: '#/definitions/DisplayIdentifier'
          services:
            type: array
            items:
              $ref: '#/definitions/ServiceConfiguration'
      - required:
          - name
  ProfileItems:
    title: ProfileItems
    allOf:
      - properties:
          items:
            type: array
            items:
              $ref: '#/definitions/Profile'
            readOnly: true
          total:
            type: integer
            description: The number of configured profiles
            readOnly: true
          filtered:
            type: integer
            description: The number of configured profiles matching the searched terms
            readOnly: true
      - required:
          - items
          - total
          - filtered
  Service:
    title: Service
    allOf:
      - properties:
          name:
            type: string
            readOnly: true
      - required:
          - name
  ServiceConfiguration:
    title: Service
    allOf:
      - properties:
          name:
            type: string
            description: The service name
          sources:
            type: array
            items:
              $ref: '#/definitions/SourceIdentifier'
            default: []
          options:
            type: object
            description: Service specific configuration options
      - required:
          - name
  ServiceItems:
    title: ServiceItems
    allOf:
      - properties:
          items:
            type: array
            items:
              $ref: '#/definitions/Service'
            readOnly: true
          total:
            type: integer
            description: The number of services
            readOnly: true
          filtered:
            type: integer
            description: The number of services matching the search filters
            readOnly: true
      - required:
          - items
          - total
          - filtered
  Source:
    title: Source
    allOf:
      - properties:
          uuid:
            type: string
            description: The UUID of the source
            readOnly: true
          backend:
            type: string
            description: The backend of this source
            readOnly: true
          name:
            type: string
            description: The name of the source
            readOnly: true
      - required:
          - uuid
          - backend
          - name
  SourceIdentifier:
    title: SourceUUID
    allOf:
      - properties:
          uuid:
            type: string
            description: The source's UUID
      - required:
        - uuid
  SourceItems:
    title: SourceItems
    allOf:
      - properties:
          items:
            type: array
            items:
              $ref: '#/definitions/Source'
            readOnly: true
          total:
            type: integer
            description: The number of sources
            readOnly: true
          filtered:
            type: integer
            description: The number of sources matching the search filters
            readOnly: true
      - required:
          - items
          - total
          - filtered
